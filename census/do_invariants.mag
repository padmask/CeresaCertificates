load "../torsion-order.mag";
load "../bound.mag";
load "curves-ht-1.mag";

P2 := ProjectiveSpace(Q,2);
ls4 := LinearSystem(P2,4);
curves := [Curve(P2,p(Domain(p)!i)): i in coefs] where p is PolynomialMap(ls4);

_,wts := DixmierOhnoInvariants(curves[1]);
wts := [i div 3: i in wts];
dois := [DixmierOhnoInvariants(c): c in curves];
nz := func<x|{@i: i in [1..#x]|x[i] ne 0@}>;
nzs := [nz(i): i in dois];

Pw := ProjectiveSpace(Q,wts);
non0 := {@x: x in [1..#dois]|dois[x,1] ne 0@};
newpts := {@@};
newinds := {@@};
sames := [];
for i in non0 do
  if Index(non0,i) mod 100 eq 0 then printf "%o", (Index(non0,i) div 100) mod 10; end if;
  pt := Pw!dois[i];
  ind := Index(newpts,pt);
  if ind eq 0 then
    Include(~newpts,pt);
    Include(~newinds,i);
  else
    Append(~sames,<newinds[ind],i>);
  end if;
end for;

// just to be sure
assert forall{x: x in sames|Pw!dois[x[1]] eq Pw!dois[x[2]]};

is0 := [x: x in [1..#dois]|dois[x,1] eq 0];
for ind in [1..#is0], j in is0[ind+1..#is0] do
  if ind mod 10 eq 0 and j eq is0[#is0] then printf "%o", (ind div 10) mod 10; end if;
  i := is0[ind];
  if nzs[i] eq nzs[j] then
    m := Min(nzs[i]);
    rat := dois[i,m]/dois[j,m] ;
    isp,rt := IsPower(rat,wts[m]);
    if isp and (forall{w: w in [1..#wts]|dois[i,w] eq dois[j,w]*rt^wts[w]} or (IsEven(wts[m]) and forall{w: w in [1..#wts]|dois[i,w] eq dois[j,w]*(-rt)^wts[w]})) then
      Append(~sames,<i,j>);
      continue ind;
    end if;
  end if;
end for;

// after sorting:
sames := [ <704, 251912>, <2609, 225958>, <2877, 145698>, <3310, 196383>, <6478, 248082>, <9006, 222477>, <9048, 197284>, <9856, 253457>, <10604, 244797>, <11763, 253295>, <12029, 254314>, <12410, 238489>, <12431, 249833>, <15671, 221574>, <15889, 250847>, <16453, 252385>, <17412, 75322>, <17435, 188792>, <17790, 234426>, <17819, 236708>, <20155, 255443>, <22027, 239322>, <23022, 249975>, <25351, 223766>, <25395, 199562>, <26336, 104029>, <28220, 251063>, <29566, 255454>, <31442, 245678>, <32384, 220638>, <33523, 251057>, <33707, 197082>, <34797, 199291>, <40992, 165723>, <42347, 177459>, <42831, 224813>, <43121, 248495>, <43552, 250636>, <43566, 249853>, <44128, 250684>, <45426, 229508>, <46870, 225933>, <50594, 186004>, <50602, 138977>, <50646, 183733>, <51383, 255385>, <51773, 251149>, <56803, 251207>, <57755, 170079>, <61746, 180245>, <61799, 183811>, <63750, 245827>, <63790, 245834>, <65498, 252328>, <65784, 231071>, <65823, 178637>, <66422, 246869>, <66438, 208918>, <67946, 234174>, <68444, 249943>, <71323, 249914>, <71969, 210234>, <71981, 242308>, <72315, 252329>, <72477, 171473>, <75259, 185790>, <76481, 192264>, <78944, 146945>, <79923, 255109>, <82282, 250666>, <82953, 115414>, <87661, 235486>, <92913, 249530>, <94468, 192184>, <97770, 249956>, <97790, 249802>, <98940, 245684>, <99044, 251868>, <100246, 249431>, <100524, 238616>, <101560, 254290>, <101581, 254063>, <103032, 252193>, <103052, 251869>, <104508, 254430>, <104529, 253914>, <105498, 252483>, <105909, 250082>, <107099, 252184>, <108122, 224882>, <108254, 250450>, <111279, 254944>, <111740, 255111>, <112573, 161259>, <113040, 251090>, <113054, 251120>, <113212, 166903>, <114556, 243684>, <115877, 251608>, <119767, 236071>, <120365, 255461>, <120407, 173261>, <120986, 253421>, <122325, 249804>, <125138, 249860>, <125228, 174630>, <126552, 251597>, <128671, 249776>, <129336, 131895>, <129359, 131918>, <129604, 253299>, <130109, 249777>, <131272, 253508>, <131536, 253247>, <131551, 253262>, <132382, 246823>, <132401, 242055>, <134324, 234323>, <135912, 183789>, <135935, 186044>, <136235, 251150>, <138845, 251216>, <138981, 180361>, <140729, 193020>, <141477, 254969>, <146826, 243138>, <147569, 238705>, <147599, 222485>, <147800, 254058>, <147812, 253918>, <148729, 254840>, <149577, 253913>, <149589, 254067>, <150571, 250091>, <150583, 250454>, <150588, 249810>, <150601, 249435>, <151060, 198960>, <151948, 254922>, <151965, 254841>, <152850, 253458>, <152851, 252591>, <153175, 252489>, <153303, 250451>, <153315, 250088>, <153320, 249432>, <153333, 249807>, <153462, 196842>, <153604, 176340>, <153633, 170332>, <154228, 187123>, <154556, 254286>, <154567, 254434>, <155364, 225685>, <155453, 254919>, <155617, 229080>, <156024, 235108>, <156300, 254429>, <156311, 254294>, <156493, 252839>, <156895, 223774>, <158943, 251911>, <161487, 251468>, <162334, 220549>, <162531, 253440>, <162890, 254022>, <162899, 251422>, <163747, 191901>, <164671, 249222>, <164802, 221917>, <165498, 254319>, <165672, 224792>, <165767, 248088>, <165944, 249436>, <166694, 251873>, <166835, 221893>, <167086, 238268>, <167383, 249816>, <168015, 254433>, <168030, 253917>, <168201, 251452>, <168734, 252190>, <168749, 251872>, <168863, 240873>, <169358, 254289>, <169373, 254062>, <169772, 250455>, <169840, 252198>, <169899, 250096>, <169974, 252137>, <170041, 241564>, <170041, 248199>, <170262, 248681>, <170349, 239964>, <170849, 246801>, <172977, 246316>, <173138, 201462>, <175304, 221569>, <176069, 239768>, <178224, 197912>, <178327, 255317>, <178390, 249427>, <178532, 253774>, <178704, 251990>, <178865, 252899>, <179106, 251864>, <179371, 248268>, <179604, 212798>, <179625, 252355>, <179646, 247037>, <179647, 210927>, <180648, 252280>, <180670, 252945>, <181175, 196357>, <181297, 248322>, <181405, 219037>, <181419, 252632>, <181807, 251876>, <181830, 252196>, <182632, 248485>, <182638, 252826>, <183025, 254066>, <183045, 254293>, <184100, 250446>, <184107, 245386>, <184815, 252186>, <185557, 250084>, <186393, 251105>, <187182, 201864>, <187603, 197922>, <188422, 252285>, <188706, 194218>, <189022, 197275>, <189806, 246833>, <189896, 250669>, <189910, 221806>, <193121, 246423>, <193378, 236588>, <193627, 252807>, <193650, 249495>, <193665, 200584>, <193666, 200585>, <193670, 197256>, <193671, 197257>, <193674, 193927>, <193675, 193928>, <193698, 200615>, <193699, 200616>, <193703, 200611>, <193704, 200612>, <193707, 200606>, <193708, 200607>, <193711, 200628>, <193712, 200629>, <193716, 200624>, <193717, 200625>, <193720, 200619>, <193721, 200620>, <193795, 200486>, <193799, 197130>, <193800, 197131>, <193831, 234441>, <193833, 200519>, <193834, 200520>, <193838, 200515>, <193839, 200516>, <193843, 200510>, <193844, 200511>, <193848, 200533>, <193849, 200534>, <193853, 200529>, <193854, 200530>, <193858, 200524>, <193859, 200525>, <193886, 247863>, <193893, 214746>, <193918, 200384>, <193919, 200385>, <193923, 197011>, <193924, 197012>, <193949, 200417>, <193950, 200418>, <193954, 197035>, <193954, 197285>, <193954, 200413>, <193955, 197036>, <193955, 197286>, <193955, 200414>, <193958, 200408>, <193959, 200409>, <193962, 200430>, <193963, 200431>, <193967, 200426>, <193968, 200427>, <193971, 200421>, <193972, 200422>, <194652, 218806>, <195006, 201927>, <195007, 201928>, <195011, 201923>, <195012, 201924>, <195015, 201918>, <195016, 201919>, <195059, 201976>, <195060, 201977>, <195064, 201972>, <195065, 201973>, <195068, 201967>, <195069, 201968>, <195128, 247956>, <195203, 201773>, <195204, 201774>, <195208, 201769>, <195209, 201770>, <195213, 201764>, <195214, 201765>, <195260, 201821>, <195261, 201822>, <195265, 201817>, <195266, 201818>, <195270, 201812>, <195271, 201813>, <195378, 201615>, <195379, 201616>, <195383, 201611>, <195384, 201612>, <195387, 201606>, <195388, 201607>, <195431, 201662>, <195432, 201663>, <195436, 201658>, <195437, 201659>, <195440, 201653>, <195441, 201654>, <195638, 217271>, <196048, 202547>, <196049, 202548>, <196053, 199532>, <196054, 199533>, <196079, 202768>, <196080, 202769>, <196084, 202764>, <196085, 202765>, <196088, 202759>, <196089, 202760>, <196092, 202781>, <196093, 202782>, <196097, 202777>, <196098, 202778>, <196101, 202772>, <196102, 202773>, <196171, 202643>, <196172, 202644>, <196176, 199649>, <196177, 199650>, <196208, 202676>, <196209, 202677>, <196213, 202672>, <196214, 202673>, <196218, 202667>, <196219, 202668>, <196222, 202689>, <196223, 202690>, <196227, 202685>, <196228, 202686>, <196232, 202680>, <196233, 202681>, <196291, 199763>, <196292, 199764>, <196319, 202578>, <196320, 202579>, <196324, 202574>, <196325, 202575>, <196328, 202569>, <196329, 202570>, <196332, 202591>, <196333, 202592>, <196337, 202587>, <196338, 202588>, <196341, 202582>, <196342, 202583>, <196833, 249778>, <197007, 197252>, <197008, 197253>, <197028, 253256>, <197040, 197281>, <197041, 197282>, <197044, 197277>, <197047, 197298>, <197048, 197299>, <197052, 197294>, <197053, 197295>, <197056, 197289>, <197057, 197290>, <197125, 197126>, <197158, 197168>, <197159, 197169>, <197163, 197164>, <197173, 197183>, <197174, 197184>, <197178, 197179>, <198128, 254250>, <198146, 254111>, <198424, 198811>, <198425, 198812>, <198429, 198807>, <198430, 198808>, <198433, 198802>, <198434, 198803>, <198477, 198864>, <198478, 198865>, <198482, 198860>, <198483, 198861>, <198486, 198855>, <198487, 198856>, <198613, 198623>, <198614, 198624>, <198618, 198619>, <198668, 198677>, <198669, 198678>, <198673, 198674>, <198813, 248278>, <198816, 252105>, <199348, 250115>, <199554, 199795>, <199555, 199796>, <199559, 199791>, <199560, 199792>, <199563, 199786>, <199564, 199787>, <199564, 252202>, <199567, 199808>, <199568, 199809>, <199572, 199804>, <199573, 199805>, <199576, 199799>, <199577, 199800>, <199645, 199646>, <199674, 199683>, <199675, 199684>, <199679, 199680>, <199687, 199696>, <199688, 199697>, <199692, 199693>, <199822, 255310>, <199843, 254690>, <200249, 253629>, <200471, 255426>, <200604, 255343>, <200614, 249874>, <200945, 223899>, <201171, 213471>, <201180, 254448>, <204038, 239979>, <204568, 251248>, <204774, 255453>, <205059, 255351>, <205440, 253462>, <205716, 240655>, <207732, 240288>, <207951, 232573>, <208854, 255322>, <208875, 253058>, <208961, 252493>, <209509, 254829>, <210169, 254059>, <210735, 249440>, <210746, 253333>, <210752, 250459>, <210932, 253230>, <210946, 212135>, <211148, 251107>, <211311, 253326>, <211602, 254833>, <212182, 212816>, <212229, 253459>, <212434, 249814>, <213155, 253146>, <213677, 244941>, <213688, 244956>, <214090, 253227>, <214272, 254287>, <214668, 237563>, <215808, 255316>, <215813, 252477>, <216505, 255347>, <216556, 250851>, <217342, 253314>, <217813, 249821>, <218978, 251415>, <220060, 224475>, <220061, 224476>, <220063, 224471>, <220064, 224472>, <220067, 224468>, <220068, 224469>, <220071, 220239>, <220072, 220238>, <220074, 222491>, <220075, 222490>, <220076, 224477>, <220145, 224412>, <220146, 224413>, <220150, 224408>, <220151, 224409>, <220154, 224404>, <220155, 224405>, <220158, 220159>, <220163, 222432>, <220164, 222431>, <220165, 224414>, <220227, 224344>, <220228, 224345>, <220230, 224340>, <220231, 224341>, <220234, 224337>, <220235, 224338>, <220241, 222351>, <220242, 222350>, <220243, 224346>, <220419, 255303>, <220646, 251162>, <220980, 225410>, <220981, 225411>, <220983, 225406>, <220984, 225407>, <220987, 225403>, <220988, 225404>, <221017, 225440>, <221018, 225441>, <221020, 225436>, <221021, 225437>, <221024, 225433>, <221025, 225434>, <221120, 225300>, <221121, 225301>, <221125, 225296>, <221126, 225297>, <221129, 225292>, <221130, 225293>, <221161, 225332>, <221162, 225333>, <221166, 225328>, <221167, 225329>, <221170, 225324>, <221171, 225325>, <221262, 225187>, <221263, 225188>, <221265, 225183>, <221266, 225184>, <221269, 225180>, <221270, 225181>, <221299, 225220>, <221300, 225221>, <221302, 225216>, <221303, 225217>, <221306, 225213>, <221307, 225214>, <221726, 225833>, <221727, 225834>, <221729, 223750>, <221730, 223751>, <221751, 225992>, <221752, 225993>, <221754, 225988>, <221755, 225989>, <221758, 225985>, <221759, 225986>, <221762, 221763>, <221765, 223780>, <221766, 223779>, <221769, 225863>, <221770, 225862>, <221827, 225904>, <221828, 225905>, <221831, 223830>, <221832, 223831>, <221858, 225931>, <221861, 225927>, <221862, 225928>, <221865, 225924>, <221866, 225925>, <221869, 221870>, <221873, 223863>, <221874, 223862>, <221875, 225932>, <221926, 223897>, <221927, 223898>, <221950, 225858>, <221951, 225859>, <221953, 225854>, <221954, 225855>, <221957, 225851>, <221958, 225852>, <221961, 221962>, <221964, 223928>, <221965, 223927>, <221990, 253949>, <222237, 254036>, <222247, 254043>, <222339, 222486>, <222340, 222487>, <222342, 222482>, <222343, 222483>, <222343, 254875>, <222346, 222479>, <222347, 222480>, <222352, 222492>, <222418, 222427>, <222419, 222428>, <222423, 222424>, <222433, 223864>, <222433, 247260>, <222433, 247261>, <222433, 247267>, <222433, 247268>, <222853, 249760>, <222862, 249787>, <222973, 250036>, <222983, 249862>, <222983, 253332>, <222987, 249869>, <222997, 250029>, <223132, 223367>, <223133, 223368>, <223135, 223363>, <223136, 223364>, <223139, 223361>, <223163, 223401>, <223164, 223402>, <223166, 223397>, <223167, 223398>, <223170, 223394>, <223171, 223395>, <223255, 223264>, <223256, 223265>, <223260, 223261>, <223292, 223300>, <223293, 223301>, <223296, 223297>, <223377, 254890>, <223626, 255329>, <223655, 254309>, <223665, 254316>, <223768, 223923>, <223769, 223924>, <223771, 223919>, <223772, 223920>, <223772, 254925>, <223775, 223916>, <223776, 223917>, <223782, 223783>, <223826, 223827>, <223851, 223858>, <223852, 223859>, <223854, 223855>, <223909, 237458>, <224474, 248921>, <224863, 251138>, <225070, 255309>, <225690, 234865>, <225849, 250962>, <225877, 228536>, <226007, 238944>, <226639, 237887>, <227980, 251455>, <228196, 241608>, <228763, 240122>, <228960, 238711>, <229266, 251096>, <230723, 244120>, <230840, 247025>, <231771, 251442>, <232132, 251722>, <232366, 238283>, <232635, 244173>, <232733, 248937>, <232798, 251781>, <232831, 255323>, <232954, 253153>, <233216, 245278>, <233915, 242704>, <235316, 251060>, <235723, 237685>, <235778, 241667>, <236161, 255107>, <236168, 238950>, <236211, 249031>, <237130, 239996>, <237131, 239997>, <237133, 238692>, <237134, 238693>, <237136, 237281>, <237137, 237282>, <237151, 240017>, <237152, 240018>, <237154, 240014>, <237155, 240015>, <237157, 240011>, <237158, 240012>, <237206, 239943>, <237208, 238630>, <237209, 238631>, <237232, 239965>, <237233, 239966>, <237235, 239961>, <237236, 239962>, <237239, 239958>, <237240, 239959>, <237275, 239887>, <237276, 239888>, <237278, 238572>, <237279, 238573>, <237296, 239908>, <237297, 239909>, <237299, 239905>, <237300, 239906>, <237302, 239902>, <237303, 239903>, <237543, 250168>, <237742, 240574>, <237743, 240575>, <237745, 240571>, <237746, 240572>, <237748, 240568>, <237749, 240569>, <237763, 240595>, <237764, 240596>, <237766, 240592>, <237767, 240593>, <237769, 240589>, <237770, 240590>, <237832, 240506>, <237833, 240507>, <237835, 240502>, <237836, 240503>, <237839, 240499>, <237840, 240500>, <237857, 240528>, <237858, 240529>, <237860, 240524>, <237861, 240525>, <237864, 240521>, <237865, 240522>, <237912, 240434>, <237913, 240435>, <237915, 240431>, <237916, 240432>, <237918, 240428>, <237919, 240429>, <237934, 240455>, <237935, 240456>, <237937, 240452>, <237938, 240453>, <237940, 240449>, <237941, 240450>, <238076, 254694>, <238151, 240789>, <238152, 240790>, <238154, 239497>, <238155, 239498>, <238193, 255424>, <238203, 240823>, <238204, 240824>, <238206, 239536>, <238207, 239537>, <238251, 239571>, <238252, 239572>, <238495, 249783>, <238569, 238689>, <238570, 238690>, <238587, 238712>, <238588, 238713>, <238588, 252056>, <238590, 238709>, <238591, 238710>, <238593, 238706>, <238594, 238707>, <238626, 238627>, <238649, 238656>, <238650, 238657>, <238652, 238653>, <239015, 254104>, <239027, 254243>, <239125, 239281>, <239126, 239282>, <239128, 239278>, <239129, 239279>, <239131, 239275>, <239132, 239276>, <239146, 239301>, <239147, 239302>, <239149, 239298>, <239150, 239299>, <239152, 239295>, <239153, 239296>, <239200, 239207>, <239201, 239208>, <239203, 239204>, <239222, 239229>, <239223, 239230>, <239225, 239226>, <239290, 244110>, <239292, 252098>, <239436, 250120>, <239533, 239534>, <239573, 253257>, <239633, 241730>, <239984, 240927>, <240477, 240962>, <240616, 251125>, <240837, 252800>, <240847, 253929>, <241244, 245974>, <241547, 245282>, <241548, 245419>, <241549, 245376>, <241550, 245201>, <241551, 247594>, <241552, 247693>, <241553, 244819>, <241554, 247521>, <241555, 248191>, <241556, 248190>, <241557, 244322>, <241558, 248189>, <241559, 248198>, <241560, 245389>, <241561, 248193>, <241562, 244833>, <241563, 248195>, <241565, 244290>, <241566, 248197>, <241567, 245362>, <241568, 248192>, <241569, 244804>, <241570, 248194>, <241571, 244240>, <241572, 248196>, <241573, 245375>, <241574, 244818>, <241575, 244321>, <241584, 247240>, <241599, 244717>, <241710, 245226>, <241895, 253288>, <242044, 247637>, <242807, 245280>, <242808, 244872>, <242809, 245430>, <242810, 245199>, <242811, 247016>, <242812, 247000>, <242813, 247023>, <242814, 247008>, <242815, 247003>, <242816, 244884>, <242817, 247011>, <242818, 247014>, <242819, 244718>, <242820, 247021>, <242821, 247006>, <242822, 247017>, <242823, 247001>, <242824, 247024>, <242825, 247009>, <242826, 247019>, <242827, 247004>, <242828, 244713>, <242829, 247012>, <242830, 247013>, <242831, 244631>, <242832, 247020>, <242833, 247005>, <242834, 247015>, <242835, 246999>, <242836, 247022>, <242837, 247007>, <242838, 247018>, <242839, 247002>, <242840, 244626>, <242841, 247010>, <242842, 245391>, <242843, 244889>, <242844, 245378>, <242845, 245364>, <242846, 244835>, <242847, 244822>, <242848, 244821>, <242849, 244806>, <242850, 244292>, <242851, 244325>, <242852, 244324>, <242853, 244242>, <243561, 252473>, <243990, 244014>, <243992, 244026>, <243993, 244003>, <243994, 244018>, <243996, 244030>, <243997, 244007>, <243998, 244022>, <244000, 244034>, <244001, 244010>, <244002, 244016>, <244004, 244028>, <244006, 244020>, <244008, 244032>, <244009, 244024>, <244011, 244036>, <244015, 244025>, <244019, 244029>, <244023, 244033>, <244273, 245244>, <244274, 244338>, <244276, 245242>, <244277, 244930>, <244279, 245239>, <244280, 245240>, <244326, 245447>, <244327, 244342>, <244327, 245457>, <244328, 247559>, <244329, 244912>, <244329, 247713>, <244330, 244913>, <244330, 244926>, <244330, 245459>, <244331, 248397>, <244332, 244340>, <244332, 245456>, <244333, 248421>, <244334, 245443>, <244335, 248422>, <244336, 248423>, <244337, 244904>, <244339, 248424>, <244341, 244925>, <244341, 244931>, <244466, 249947>, <244553, 246820>, <244628, 244715>, <244629, 244716>, <244669, 244675>, <244670, 244676>, <244672, 244673>, <244676, 252130>, <244812, 254180>, <244869, 246045>, <244870, 246030>, <244891, 247557>, <244893, 245451>, <244906, 244927>, <244908, 245458>, <244909, 244910>, <244909, 247263>, <244909, 247271>, <244911, 247719>, <244914, 247714>, <244915, 247712>, <244916, 247715>, <244917, 247716>, <244918, 247233>, <244919, 247228>, <244920, 247717>, <244921, 247718>, <244922, 247702>, <244923, 247720>, <244924, 245445>, <244928, 244929>, <245040, 251594>, <245052, 250863>, <245211, 246955>, <245432, 245454>, <245446, 245455>, <246014, 247977>, <246025, 246028>, <246026, 246046>, <246029, 246031>, <246032, 246041>, <246033, 246040>, <246035, 246043>, <246036, 246042>, <246038, 246044>, <246297, 252292>, <246451, 249830>, <246543, 247242>, <246547, 247662>, <246649, 253427>, <246774, 249429>, <246991, 252264>, <247117, 254173>, <247230, 247231>, <247231, 254902>, <247253, 249952>, <247262, 247265>, <247264, 247269>, <247266, 247270>, <247658, 251580>, <247712, 252135>, <247938, 255261>, <248049, 251094>, <248169, 251101>, <248227, 251463>, <248328, 251417>, <248396, 253441>, <248710, 254700>, <248747, 251093>, <248922, 255098>, <248953, 251336>, <249818, 255076>, <249875, 255099>, <249965, 251065>, <249988, 250663>, <249995, 251714>, <250674, 254962>, <251055, 255462>, <251110, 255049>, <251110, 255159>, <251159, 255315>, <251219, 252159>, <251232, 255062>, <251261, 252761>, <251409, 253334>, <251572, 255263>, <252062, 255437>, <252371, 253687>, <252773, 255427>, <252928, 254461>, <253383, 254981>, <253412, 255521>, <253429, 255507>, <253469, 255463>, <254603, 254644>, <255425, 255470> ];
